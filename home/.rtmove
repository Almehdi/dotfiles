#!/bin/zsh

## Where the files are located
file_dir="$HOME/.cache/rtorrent/incomplete/"

sleep 2

echo "$(date +'[%y%m%d-%T]')" >> rtorrent.log
echo "1:$1\n" >> rtorrent.log

## Move movie files to incomplete dir if they are in a "rarbg" folder
if [ $(grep -o "rarbg" <<<$1) ]; then
	mv $file_dir/*\[rarbg\]/*.mkv $file_dir
	1=$(sed 's/\[rarbg\]//' <<<$file_dir$(basename $1.mkv))
	rm -drf $file_dir/*\[rarbg\]/
fi

echo "2:$1\n" >> rtorrent.log

sleep 2

## Move documents to ~/Documents
if [ $(grep -iE '*.[Dd][Oo][Cc]|[Pp][Dd][Ff]|[Oo][Dd][Tt]|[Tt][Xx][Tt]' <<<"$1") ]; then
	mv -u $1 ~/Documents
	ln -s ~/Documents/$(basename $1) $1
	exit 0
elif [ $(grep -iE '*.[Aa][Vv][Ii]|[Mm][Pp]4|[Mm][Kk][Vv]|[Mm][Pp][Gg]|[Mm][Pp][Ee][Gg]|[Ff][Ll][Vv]' <<<"$1") ]; then
	mv -u $1 ~/Videos
	ln -s ~/Videos/$(basename $1) $1
	exit 0
else
	mv -u $1 ~/Downloads;ln -s ~/Downloads/$(basename $1) $1
	exit 0
fi
